<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Simulador e Proje√ß√£o de NPS</title>
  <!-- Incluindo Tailwind CSS para estiliza√ß√£o -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Incluindo as bibliotecas React, ReactDOM, prop-types, Recharts e Babel para transpilar o c√≥digo JSX -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/prop-types@15.8.1/prop-types.js"></script>
  <script crossorigin src="https://unpkg.com/recharts@2.8.0/umd/Recharts.js"></script>
  <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    /* Estilo para a fonte "Inter" */
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    body {
      font-family: 'Inter', sans-serif;
    }
  </style>
</head>
<body class="bg-gray-100 p-4 md:p-8">
  <div id="root"></div>

  <script type="text/babel">
    // Garantir que todo o c√≥digo React seja executado ap√≥s o carregamento completo da p√°gina
    window.onload = function() {
      const { useState, useMemo, useEffect } = React;
      const { createRoot } = ReactDOM;

      // Adicionar um pequeno atraso para garantir que Recharts esteja totalmente carregado e dispon√≠vel
      // e verificar se window.Recharts est√° definido
      setTimeout(() => {
        if (typeof window.Recharts === 'undefined') {
          console.error("A biblioteca Recharts n√£o foi carregada. Por favor, verifique a tag script para Recharts.js");
          const rootElement = document.getElementById('root');
          if (rootElement) {
            const root = createRoot(rootElement);
            root.render(
              <div className="text-center p-8 text-red-600 font-bold">
                Erro ao carregar o gr√°fico. Por favor, tente novamente ou verifique sua conex√£o.
              </div>
            );
          }
          return;
        }

        const {
          LineChart,
          Line,
          XAxis,
          YAxis,
          CartesianGrid,
          Tooltip,
          Legend,
          ResponsiveContainer
        } = window.Recharts; // Acessando Recharts diretamente do objeto window

        // Componentes recriados do shadcn para evitar erros de importa√ß√£o e manter o estilo
        const Card = ({ children, className }) => (
          <div className={`rounded-xl border bg-white text-card-foreground shadow-lg transition-all duration-300 hover:shadow-2xl ${className}`}>
            {children}
          </div>
        );

        const CardHeader = ({ children, className }) => (
          <div className={`flex flex-col space-y-1.5 p-6 ${className}`}>
            {children}
          </div>
        );

        const CardTitle = ({ children, className }) => (
          <h3 className={`font-bold tracking-tight text-3xl ${className}`}>
            {children}
          </h3>
        );

        const CardDescription = ({ children, className }) => (
          <p className={`text-base text-gray-600 ${className}`}>
            {children}
          </p>
        );

        const CardContent = ({ children, className }) => (
          <div className={`p-6 pt-0 ${className}`}>
            {children}
          </div>
        );

        const Button = ({ children, className, onClick, ...props }) => (
          <button
            className={`inline-flex items-center justify-center whitespace-nowrap rounded-lg text-sm font-semibold transition-colors duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-11 px-6 py-3 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 active:translate-y-0.5 ${className}`}
            onClick={onClick}
            {...props}
          >
            {children}
          </button>
        );

        const Input = ({ className, type, value, onChange, disabled, ...props }) => (
          <input
            type={type}
            value={value}
            onChange={onChange}
            disabled={disabled}
            className={`flex h-11 w-full rounded-lg border border-gray-300 bg-white px-4 py-2 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-400 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 disabled:cursor-not-allowed disabled:bg-gray-100 disabled:text-gray-500 ${className}`}
            {...props}
          />
        );
        
        const Textarea = ({ className, value, onChange, disabled, placeholder, ...props }) => (
          <textarea
            value={value}
            onChange={onChange}
            disabled={disabled}
            placeholder={placeholder}
            className={`flex min-h-[80px] w-full rounded-lg border border-gray-300 bg-white px-4 py-2 text-base shadow-sm transition-colors placeholder:text-gray-400 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 disabled:cursor-not-allowed disabled:bg-gray-100 disabled:text-gray-500 ${className}`}
            {...props}
          />
        );

        const Label = ({ children, className, htmlFor }) => (
          <label
            htmlFor={htmlFor}
            className={`text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 ${className}`}
          >
            {children}
          </label>
        );

        const Tabs = ({ children, defaultValue }) => {
          const [activeTab, setActiveTab] = useState(defaultValue);
          return (
            <div className="flex flex-col">
              {React.Children.map(children, child =>
                React.cloneElement(child, { activeTab, setActiveTab })
              )}
            </div>
          );
        };

        const TabsList = ({ children, className, activeTab, setActiveTab }) => (
          <div className={`inline-flex h-11 items-center justify-center rounded-xl bg-gray-200 p-1 text-gray-600 shadow-inner ${className}`}>
            {React.Children.map(children, child =>
              React.cloneElement(child, { activeTab, setActiveTab })
            )}
          </div>
        );

        const TabsTrigger = ({ children, value, className, activeTab, setActiveTab }) => (
          <button
            className={`inline-flex items-center justify-center whitespace-nowrap rounded-lg px-4 py-2 text-base font-semibold ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 ${
              activeTab === value ? 'bg-white text-gray-900 shadow-md transform scale-105' : 'hover:bg-gray-300'
            } ${className}`}
            onClick={() => setActiveTab(value)}
          >
            {children}
          </button>
        );

        const TabsContent = ({ children, value, className, activeTab }) => (
          <div className={`mt-4 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ${
            activeTab === value ? '' : 'hidden'
          } ${className}`}>
            {children}
          </div>
        );

        const App = () => {
          // Dados para a aba de Proje√ß√£o de NPS (dados originais)
          const initialCombinedData = [
            { month: 'Jan', prom: 990, neutr: 26, detra: 13, status: 'Fechado' },
            { month: 'Fev', prom: 975, neutr: 38, detra: 26, status: 'Fechado' },
            { month: 'Mar', prom: 1412, neutr: 48, detra: 44, status: 'Fechado' },
            { month: 'Abr', prom: 1396, neutr: 62, detra: 47, status: 'Fechado' },
            { month: 'Mai', prom: 1243, neutr: 86, detra: 51, status: 'Fechado' },
            { month: 'Jun', prom: 1334, neutr: 61, detra: 28, status: 'Fechado' },
            { month: 'Jul', prom: 1018, neutr: 52, detra: 41, status: 'Fechado' }
          ];
          const allMonths = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
          const initialProjectionData = useMemo(() => {
            const fullData = [...initialCombinedData];
            // Inicializa os meses projetados com string vazia para preenchimento manual
            for (let i = initialCombinedData.length; i < allMonths.length; i++) {
              fullData.push({
                month: allMonths[i],
                prom: '',
                neutr: '',
                detra: '',
                status: 'Projetado',
              });
            }
            return fullData;
          }, []);

          const [data, setData] = useState(initialProjectionData);
          const [totalNotas, setTotalNotas] = useState(1000);
          const [inverseResults, setInverseResults] = useState([]);
          const [annualGoalResult, setAnnualGoalResult] = useState(null);
          const [projectedTotalNotes, setProjectedTotalNotes] = useState(1000);
          
          const calculateNps = (promoters, detractors, total) => {
            if (total === 0 || total === null || isNaN(total)) return 0;
            return parseFloat(((promoters - detractors) / total) * 100).toFixed(1);
          };

          // Fun√ß√µes para a aba de Proje√ß√£o de NPS
          const npsProjectionData = useMemo(() => {
            return data.map(monthData => {
              // Converte strings vazias para 0 para o c√°lculo
              const promoters = parseFloat(monthData.prom) || 0;
              const neutrals = parseFloat(monthData.neutr) || 0;
              const detractors = parseFloat(monthData.detra) || 0;
              const totalVolume = promoters + neutrals + detractors;
              const npsCx = calculateNps(promoters, detractors, totalVolume);
              return { ...monthData, totalVolume, npsCx };
            });
          }, [data]);
          const annualTotals = useMemo(() => {
            const totalProm = npsProjectionData.reduce((sum, d) => sum + (parseFloat(d.prom) || 0), 0);
            const totalNeutr = npsProjectionData.reduce((sum, d) => sum + (parseFloat(d.neutr) || 0), 0);
            const totalDetra = npsProjectionData.reduce((sum, d) => sum + (parseFloat(d.detra) || 0), 0);
            const totalVolume = totalProm + totalNeutr + totalDetra;
            const annualNps = calculateNps(totalProm, totalDetra, totalVolume);
            return { totalProm, totalNeutr, totalDetra, totalVolume, annualNps };
          }, [npsProjectionData]);
          const neutralPerDetractor = useMemo(() => {
            const closedData = initialCombinedData.filter(d => d.status === 'Fechado');
            const totalNeutrosFechado = closedData.reduce((sum, d) => sum + d.neutr, 0);
            const totalDetratoresFechado = closedData.reduce((sum, d) => sum + d.detra, 0);
            return totalDetratoresFechado > 0 ? parseFloat(totalNeutrosFechado / totalDetratoresFechado).toFixed(1) : 0;
          }, []);
          const handleProjectionChange = (index, type, value) => {
            const newData = [...data];
            newData[index][type] = value;
            setData(newData);
          };
          const handleStatusChange = (index, newStatus) => {
            const newData = [...data];
            newData[index].status = newStatus;
            if (newStatus === 'Projetado') {
                // Ao mudar para projetado, zera os valores para preenchimento manual
                newData[index].prom = '';
                newData[index].neutr = '';
                newData[index].detra = '';
            }
            setData(newData);
          };
          const handleInverseCalculation = () => {
            const targetNps = 95;
            const results = [];
            const closedData = data.filter(d => d.status === 'Fechado');
            const initialTotalNotes = closedData.reduce((sum, d) => sum + d.prom + d.neutr + d.detra, 0);
            const initialTotalNeutrals = closedData.reduce((sum, d) => sum + d.neutr, 0);
            const neutralRatio = initialTotalNotes > 0 ? initialTotalNeutrals / initialTotalNotes : 0;
            for (let i = 0; i < 12; i++) {
              const notes = totalNotas;
              const neutrals = Math.round(notes * neutralRatio);
              const equation1 = (targetNps / 100) * notes;
              const equation2 = notes - neutrals;
              const promoters = Math.round((equation1 + equation2) / 2);
              const detractors = Math.round((equation2 - equation1) / 2);
              results.push({
                month: allMonths[i],
                totalNotas: notes,
                promotores: promoters,
                detratores: detractors,
                neutros: neutrals,
                npsCalculado: calculateNps(promoters, detractors, notes),
              });
            }
            setInverseResults(results);
          };
          const handleAnnualGoalCalculation = () => {
            const monthsPast = data.filter(d => d.status === 'Fechado').length;
            const monthsToProject = allMonths.length - monthsPast;
            const annualTargetNps = 95;
            const pastMetrics = data.filter(d => d.status === 'Fechado').reduce((acc, curr) => {
              acc.totalVolume += curr.prom + curr.neutr + curr.detra;
              acc.totalPromoters += curr.prom;
              acc.totalNeutrals += curr.neutr;
              acc.totalDetractors += curr.detra;
              return acc;
            }, { totalVolume: 0, totalPromoters: 0, totalNeutrals: 0, totalDetractors: 0 });
            const projectedTotalAnnualVolume = pastMetrics.totalVolume + (monthsToProject * projectedTotalNotes);
            const currentNps = calculateNps(pastMetrics.totalPromoters, pastMetrics.totalDetractors, pastMetrics.totalVolume);
            const neutralRatio = pastMetrics.totalVolume > 0 ? pastMetrics.totalNeutrals / pastMetrics.totalVolume : 0;
            const targetPromotersDetractorsSum = projectedTotalAnnualVolume - (projectedTotalAnnualVolume * neutralRatio);
            const targetPromotersDetractorsDiff = (annualTargetNps / 100) * projectedTotalAnnualVolume;
            const totalPromotersNeeded = Math.round((targetPromotersDetractorsSum + targetPromotersDetractorsDiff) / 2);
            const totalDetractorsNeeded = Math.round((targetPromotersDetractorsSum - targetPromotersDetractorsDiff) / 2);
            const totalNeutralsNeeded = Math.round(projectedTotalAnnualVolume * neutralRatio);
            const remainingPromotersNeeded = totalPromotersNeeded - pastMetrics.totalPromoters;
            const remainingDetractorsNeeded = totalDetractorsNeeded - pastMetrics.totalDetractors;
            const remainingNeutralsNeeded = totalNeutralsNeeded - pastMetrics.totalNeutrals;
            let isAchievable = true;
            let maxNps = 0;
            if (remainingPromotersNeeded < 0 || remainingDetractorsNeeded < 0 || remainingNeutralsNeeded < 0 || monthsToProject <= 0) {
              isAchievable = false;
              const maxPossiblePromoters = pastMetrics.totalPromoters + (monthsToProject * (projectedTotalNotes - Math.round(projectedTotalNotes * neutralRatio)));
              const maxPossibleDetractors = pastMetrics.totalDetractors;
              maxNps = calculateNps(maxPossiblePromoters, maxPossibleDetractors, projectedTotalAnnualVolume);
            }
            setAnnualGoalResult({
              isAchievable,
              currentNps,
              projectedTotalAnnualVolume,
              targetNps: annualTargetNps,
              maxNps,
              monthlyPromoters: isAchievable && monthsToProject > 0 ? Math.round(remainingPromotersNeeded / monthsToProject) : 'N/A',
              monthlyDetractors: isAchievable && monthsToProject > 0 ? Math.round(remainingDetractorsNeeded / monthsToProject) : 'N/A',
              monthlyNeutrals: isAchievable && monthsToProject > 0 ? Math.round(remainingNeutralsNeeded / monthsToProject) : 'N/A',
            });
          };

          // DADOS E FUN√á√ïES PARA A ABA DE CORRELA√á√ÉO
          const correlationMonths = ['Jan/24', 'Fev/24', 'Mar/24', 'Abr/24', 'Mai/24', 'Jun/24', 'Jul/24', 'Ago/24', 'Set/24', 'Out/24', 'Nov/24', 'Dez/24', 'Jan/25', 'Fev/25', 'Mar/25', 'Abr/25', 'Mai/25', 'Jun/25', 'Jul/25', 'Ago/25', 'Set/25', 'Out/25', 'Nov/25', 'Dez/25'];
          const correlationInitialData = [
            { month: 'Jan/24', indicadorA: 95.4, indicadorB: 69.5, status: 'Fechado' },
            { month: 'Fev/24', indicadorA: 95.3, indicadorB: 67.2, status: 'Fechado' },
            { month: 'Mar/24', indicadorA: 93.4, indicadorB: 57.1, status: 'Fechado' },
            { month: 'Abr/24', indicadorA: 94.8, indicadorB: 63.2, status: 'Fechado' },
            { month: 'Mai/24', indicadorA: 96.4, indicadorB: 67.2, status: 'Fechado' },
            { month: 'Jun/24', indicadorA: 95, indicadorB: 63.6, status: 'Fechado' },
            { month: 'Jul/24', indicadorA: 96.1, indicadorB: 65.5, status: 'Fechado' },
            { month: 'Ago/24', indicadorA: 95.3, indicadorB: 61.6, status: 'Fechado' },
            { month: 'Set/24', indicadorA: 94.2, indicadorB: 61.8, status: 'Fechado' },
            { month: 'Out/24', indicadorA: 94.3, indicadorB: 59.1, status: 'Fechado' },
            { month: 'Nov/24', indicadorA: 94.5, indicadorB: 60, status: 'Fechado' },
            { month: 'Dez/24', indicadorA: 95.4, indicadorB: 56.8, status: 'Fechado' },
            { month: 'Jan/25', indicadorA: 94.9, indicadorB: 59.9, status: 'Fechado' },
            { month: 'Fev/25', indicadorA: 91.3, indicadorB: 57.8, status: 'Fechado' },
            { month: 'Mar/25', indicadorA: 91, indicadorB: 48.6, status: 'Fechado' },
            { month: 'Abr/25', indicadorA: 89.6, indicadorB: 46.2, status: 'Fechado' },
            { month: 'Mai/25', indicadorA: 86.4, indicadorB: 46.9, status: 'Fechado' },
            { month: 'Jun/25', indicadorA: 91.8, indicadorB: 43.3, 'status': 'Fechado' },
            { month: 'Jul/25', indicadorA: 87.9, indicadorB: 49.6, 'status': 'Fechado' },
          ];
          const [correlationData, setCorrelationData] = useState(() => {
            const fullData = [...correlationInitialData];
            // Inicializa os meses projetados com string vazia para preenchimento manual
            for (let i = correlationInitialData.length; i < correlationMonths.length; i++) {
              fullData.push({
                month: correlationMonths[i],
                indicadorA: '',
                indicadorB: '',
                status: 'Projetado',
              });
            }
            return fullData;
          });
          const handleCorrelationProjectionChange = (index, type, value) => {
            const newData = [...correlationData];
            newData[index][type] = value;
            setCorrelationData(newData);
          };
          const handleCorrelationStatusChange = (index, newStatus) => {
            const newData = [...correlationData];
            newData[index].status = newStatus;
            if (newStatus === 'Projetado') {
              // Ao mudar para projetado, zera os valores para preenchimento manual
              newData[index].indicadorA = '';
              newData[index].indicadorB = '';
            }
            setCorrelationData(newData);
          };
          const correlationResult = useMemo(() => {
            const closedData = correlationData.filter(d => d.status === 'Fechado' && d.indicadorA !== '' && d.indicadorB !== '');
            if (closedData.length < 2) return null;
            const n = closedData.length;
            let sumX = 0, sumY = 0, sumXY = 0, sumX2 = 0, sumY2 = 0;
            closedData.forEach(d => {
              sumX += parseFloat(d.indicadorA);
              sumY += parseFloat(d.indicadorB);
              sumXY += parseFloat(d.indicadorA) * parseFloat(d.indicadorB);
              sumX2 += Math.pow(parseFloat(d.indicadorA), 2);
              sumY2 += Math.pow(parseFloat(d.indicadorB), 2);
            });
            const numerator = (n * sumXY) - (sumX * sumY);
            const denominator = Math.sqrt(((n * sumX2) - Math.pow(sumX, 2)) * ((n * sumY2) - Math.pow(sumY, 2)));
            const correlation = denominator === 0 ? 0 : numerator / denominator;
            return correlation;
          }, [correlationData]);
          const correlationExplanation = useMemo(() => {
            if (correlationResult === null) {
              return "N√£o h√° dados suficientes para calcular a correla√ß√£o.";
            }
            const absR = Math.abs(correlationResult);
            if (absR >= 0.7) {
              return `Correla√ß√£o ${correlationResult > 0 ? 'positiva' : 'negativa'} forte. Existe uma forte rela√ß√£o linear entre os indicadores.`;
            }
            if (absR >= 0.3 && absR < 0.7) {
              return `Correla√ß√£o ${correlationResult > 0 ? 'positiva' : 'negativa'} m√©dia. Existe uma rela√ß√£o linear percept√≠vel entre os indicadores.`;
            }
            return "Correla√ß√£o fraca ou inexistente. N√£o h√° uma rela√ß√£o linear clara entre os indicadores.";
          }, [correlationResult]);
          
          // DADOS E FUN√á√ïES PARA A NOVA ABA DE AN√ÅLISE MENSAL
          const [monthlyAnalysisData, setMonthlyAnalysisData] = useState({ 
            collaboratorName: '',
            lastClosedProm: '', 
            lastClosedNeut: '', 
            lastClosedDetra: '',
            partialProm: '',
            partialNeut: '',
            partialDetra: '',
            npsGoal: '95', 
            totalWorkingDays: '22',
            currentWorkingDay: '15',
          });

          const handleMonthlyAnalysisChange = (field, value) => {
            setMonthlyAnalysisData(prev => ({ ...prev, [field]: value }));
          };
          
          const monthlyAnalysisCalcs = useMemo(() => {
            // Dados do √∫ltimo registo fechado (apenas para exibi√ß√£o)
            const lastClosedProm = Number(monthlyAnalysisData.lastClosedProm) || 0;
            const lastClosedNeut = Number(monthlyAnalysisData.lastClosedNeut) || 0;
            const lastClosedDetra = Number(monthlyAnalysisData.lastClosedDetra) || 0;
            const totalLastClosedVolume = lastClosedProm + lastClosedNeut + lastClosedDetra;
            const lastClosedNps = calculateNps(lastClosedProm, lastClosedDetra, totalLastClosedVolume);

            // Dados parciais do m√™s (base para proje√ß√£o)
            const cProm = Number(monthlyAnalysisData.partialProm) || 0;
            const cNeut = Number(monthlyAnalysisData.partialNeut) || 0;
            const cDetra = Number(monthlyAnalysisData.partialDetra) || 0;
            const totalPartialVolume = cProm + cNeut + cDetra;
            const partialNps = calculateNps(cProm, cDetra, totalPartialVolume);

            // Dados de proje√ß√£o
            const npsGoal = Number(monthlyAnalysisData.npsGoal) || 95;
            const totalWorkingDays = Number(monthlyAnalysisData.totalWorkingDays) || 1;
            const currentWorkingDay = Number(monthlyAnalysisData.currentWorkingDay) || 0;

            const remainingWorkingDays = Math.max(0, totalWorkingDays - currentWorkingDay);
            const dailyAverageVolume = currentWorkingDay > 0 ? totalPartialVolume / currentWorkingDay : 0;
            const projectedAdditionalVolume = Math.round(dailyAverageVolume * remainingWorkingDays);
            const finalProjectedVolume = totalPartialVolume + projectedAdditionalVolume;

            const calculateScenarios = () => {
              if (finalProjectedVolume === 0) return [];
              
              const scenarios = [];
              
              // Fun√ß√£o para calcular o NPS final de um cen√°rio
              const getFinalNps = (futureProm, futureNeut, futureDetra) => {
                const finalProm = cProm + futureProm;
                const finalDetra = cDetra + futureDetra;
                return calculateNps(finalProm, finalDetra, finalProjectedVolume);
              };

              // Cen√°rio 1: Atingir a meta com 0 detratores futuros
              let neededProm_s1 = 0;
              let neededNeut_s1 = 0;
              let isPossible_s1 = false;
              for (let p = projectedAdditionalVolume; p >= 0; p--) {
                  const n = projectedAdditionalVolume - p;
                  const finalNPS = getFinalNps(p, n, 0);
                  if (finalNPS >= npsGoal) {
                      neededProm_s1 = p;
                      neededNeut_s1 = n;
                      isPossible_s1 = true;
                      break;
                  }
              }
              if (isPossible_s1) {
                 scenarios.push({
                    name: `Alcan√ßar ${npsGoal}% (sem detratores)`,
                    prom: cProm + neededProm_s1,
                    neut: cNeut + neededNeut_s1,
                    detra: cDetra,
                    nps: calculateNps(cProm + neededProm_s1, cDetra, finalProjectedVolume),
                    isPossible: true
                 });
              }

              // Cen√°rio 2: Atingir a meta com no m√°ximo 1 neutro futuro
              let neededProm_s2 = 0;
              let neededDetra_s2 = 0;
              let isPossible_s2 = false;
              if(projectedAdditionalVolume > 0) {
                for (let p = projectedAdditionalVolume -1; p >= 0; p--) {
                    const d = projectedAdditionalVolume - 1 - p;
                    const finalNPS = getFinalNps(p, 1, d);
                    if (finalNPS >= npsGoal) {
                        neededProm_s2 = p;
                        neededDetra_s2 = d;
                        isPossible_s2 = true;
                        break;
                    }
                }
              }
              if (isPossible_s2) {
                 scenarios.push({
                    name: `Alcan√ßar ${npsGoal}% (com 1 neutro)`,
                    prom: cProm + neededProm_s2,
                    neut: cNeut + 1,
                    detra: cDetra + neededDetra_s2,
                    nps: calculateNps(cProm + neededProm_s2, cDetra + neededDetra_s2, finalProjectedVolume),
                    isPossible: true
                 });
              }
              
              // Cen√°rio 3: Aumentar em 5 promotores
              if(projectedAdditionalVolume >= 5) {
                const remainingForNeutDetra = projectedAdditionalVolume - 5;
                const finalProm_s3 = cProm + 5;
                const finalNeut_s3 = cNeut + remainingForNeutDetra;
                const finalDetra_s3 = cDetra;
                scenarios.push({
                    name: `Aumentar em 5 Promotores`,
                    prom: finalProm_s3,
                    neut: finalNeut_s3,
                    detra: finalDetra_s3,
                    nps: calculateNps(finalProm_s3, finalDetra_s3, finalProjectedVolume),
                    isPossible: true
                 });
              }

              // Desafio: Se nenhum cen√°rio atingir a meta, calcular o NPS m√°ximo poss√≠vel
              if (scenarios.filter(s => s.nps >= npsGoal).length === 0) {
                const maxProm = cProm + projectedAdditionalVolume;
                const maxNps = calculateNps(maxProm, cDetra, finalProjectedVolume);
                scenarios.push({
                  name: `Desafio (NPS M√°ximo Poss√≠vel)`,
                  prom: maxProm,
                  neut: cNeut,
                  detra: cDetra,
                  nps: maxNps,
                  isPossible: false,
                  message: `A meta de ${npsGoal}% n√£o √© alcan√ß√°vel. O m√°ximo poss√≠vel √© ${maxNps}%.`
                });
              }
              
              return scenarios;
            };

            const goalScenarios = calculateScenarios();

            return {
              lastClosedNps,
              totalLastClosedVolume,
              partialNps,
              totalPartialVolume,
              finalProjectedVolume,
              remainingWorkingDays,
              goalScenarios
            };

          }, [monthlyAnalysisData]);


          return (
            <div className="w-full max-w-7xl mx-auto space-y-8">
              <Card className="p-8">
                <CardHeader>
                  <CardTitle>Simulador e Proje√ß√£o de NPS</CardTitle>
                  <CardDescription>
                    Ferramenta para an√°lise e proje√ß√£o de indicadores de performance.
                  </CardDescription>
                </CardHeader>
                <CardContent>
                  <Tabs defaultValue="monthlyAnalysis">
                    <TabsList className="grid w-full grid-cols-2 md:grid-cols-4 mb-8">
                      <TabsTrigger value="projection">Proje√ß√£o de NPS</TabsTrigger>
                      <TabsTrigger value="inverse">C√°lculo Inverso</TabsTrigger>
                      <TabsTrigger value="correlation">Correla√ß√£o</TabsTrigger>
                      <TabsTrigger value="monthlyAnalysis">An√°lise Mensal</TabsTrigger>
                    </TabsList>

                    {/* ABA PROJE√á√ÉO DE NPS */}
                    <TabsContent value="projection" className="mt-4">
                      <h3 className="text-2xl font-bold mb-4 text-gray-800">Proje√ß√£o de NPS Consolidado</h3>
                      <p className="text-gray-600 mb-6">
                        Ajuste os volumes de promotores, detratores e neutros para a vis√£o consolidada de todos os canais e veja a proje√ß√£o do NPS.
                      </p>
                      <div className="overflow-x-auto mb-6 rounded-xl shadow-lg">
                        <table className="w-full text-left border-collapse">
                          <thead>
                            <tr className="bg-red-700 text-white font-bold text-base">
                              <th className="p-4 border-r rounded-tl-xl">M√™s</th>
                              <th className="p-4 border-r">Status</th>
                              <th className="p-4 text-center">Promotores</th>
                              <th className="p-4 text-center">Neutros
                                <span className="block text-xs font-normal text-red-100 mt-1">
                                  (1 Detrator ‚âà {neutralPerDetractor} Neutros)
                                </span>
                              </th>
                              <th className="p-4 text-center">Detratores</th>
                              <th className="p-4 text-center">Vol. Total</th>
                              <th className="p-4 text-center rounded-tr-xl">NPS CX</th>
                            </tr>
                          </thead>
                          <tbody>
                            {npsProjectionData.map((monthData, index) => (
                              <tr key={index} className={`border-b border-gray-200 ${monthData.status === 'Projetado' ? 'bg-red-50 text-red-800 font-semibold' : 'hover:bg-gray-50'}`}>
                                <td className="p-4 font-medium border-r">{monthData.month}</td>
                                <td className="p-4 border-r text-sm text-center">
                                  <select
                                    value={monthData.status}
                                    onChange={(e) => handleStatusChange(index, e.target.value)}
                                    className={`block w-full rounded-md border border-gray-300 p-2 text-sm shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500
                                    ${monthData.status === 'Fechado' ? 'bg-gray-200 text-gray-600' : 'bg-white text-gray-900'}`}
                                  >
                                    <option value="Fechado">Fechado</option>
                                    <option value="Projetado">Projetado</option>
                                  </select>
                                </td>
                                <td className="p-4 text-center">
                                  <Input
                                    type="number"
                                    value={monthData.prom}
                                    onChange={(e) => handleProjectionChange(index, 'prom', e.target.value)}
                                    className="w-full text-center"
                                    disabled={monthData.status === 'Fechado'}
                                  />
                                </td>
                                <td className="p-4 text-center">
                                  <Input
                                    type="number"
                                    value={monthData.neutr}
                                    onChange={(e) => handleProjectionChange(index, 'neutr', e.target.value)}
                                    className="w-full text-center"
                                    disabled={monthData.status === 'Fechado'}
                                  />
                                </td>
                                <td className="p-4 text-center">
                                  <Input
                                    type="number"
                                    value={monthData.detra}
                                    onChange={(e) => handleProjectionChange(index, 'detra', e.target.value)}
                                    className="w-full text-center"
                                    disabled={monthData.status === 'Fechado'}
                                  />
                                </td>
                                <td className="p-4 font-bold text-gray-600 text-center">{monthData.totalVolume}</td>
                                <td className="p-4 font-bold text-red-800 text-center">{monthData.npsCx}%</td>
                              </tr>
                            ))}
                            {/* Linha de Subtotal Anual */}
                            <tr className="bg-red-800 text-white font-bold text-lg rounded-b-xl">
                              <td className="p-4 rounded-bl-xl" colSpan="2">Subtotal Anual</td>
                              <td className="p-4 text-center">{annualTotals.totalProm}</td>
                              <td className="p-4 text-center">{annualTotals.totalNeutr}</td>
                              <td className="p-4 text-center">{annualTotals.totalDetra}</td>
                              <td className="p-4 text-center">{annualTotals.totalVolume}</td>
                              <td className="p-4 text-center rounded-br-xl">{annualTotals.annualNps}%</td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      <Card className="bg-blue-50 border-blue-200 mt-8">
                        <CardHeader>
                          <CardTitle className="text-2xl text-blue-800">An√°lise de Meta Anual (NPS 95)</CardTitle>
                          <CardDescription className="text-blue-700">
                            Com base no volume projetado, veja a distribui√ß√£o necess√°ria para atingir a meta de NPS 95 para o ano.
                          </CardDescription>
                        </CardHeader>
                        <CardContent>
                          <div className="flex flex-col md:flex-row items-end space-y-4 md:space-y-0 md:space-x-4 mb-4">
                            <div className="flex-grow w-full">
                              <Label htmlFor="projected-total-notes" className="text-base text-gray-700">Volume de Notas Projetado por M√™s</Label>
                              <Input
                                id="projected-total-notes"
                                type="number"
                                value={projectedTotalNotes}
                                onChange={(e) => setProjectedTotalNotes(parseInt(e.target.value, 10) || 0)}
                                className="mt-2 text-center"
                              />
                            </div>
                            <Button onClick={handleAnnualGoalCalculation} className="bg-blue-600 hover:bg-blue-700 text-white shadow-lg w-full md:w-auto">
                              Calcular Meta Anual
                            </Button>
                          </div>
                          {annualGoalResult && (
                            <div className="mt-4">
                              <p className="text-xl font-bold text-blue-900">Resumo do Ano:</p>
                              <ul className="list-disc list-inside space-y-2 mt-2 text-gray-700">
                                <li>NPS Acumulado at√© o momento: <span className="font-bold text-blue-800">{annualGoalResult.currentNps}%</span></li>
                                <li>Volume Total Anual Projetado: <span className="font-bold">{annualGoalResult.projectedTotalAnnualVolume}</span> notas</li>
                              </ul>
                              {annualGoalResult.isAchievable ? (
                                <div className="mt-4 p-6 rounded-lg bg-green-100 text-green-800 border border-green-300">
                                  <p className="font-extrabold text-xl">üéâ A meta anual de NPS 95% √© alcan√ß√°vel!</p>
                                  <p className="mt-2">Para alcan√ßar a meta, a distribui√ß√£o mensal necess√°ria √©:</p>
                                  <ul className="mt-2 list-disc list-inside font-semibold">
                                    <li>Promotores por M√™s: <span className="font-extrabold text-green-900">{annualGoalResult.monthlyPromoters}</span></li>
                                    <li>Neutros por M√™s: <span className="font-extrabold text-green-900">{annualGoalResult.monthlyNeutrals}</span></li>
                                    <li>Detratores por M√™s: <span className="font-extrabold text-green-900">{annualGoalResult.monthlyDetractors}</span></li>
                                  </ul>
                                </div>
                              ) : (
                                <div className="mt-4 p-6 rounded-lg bg-red-100 text-red-800 border border-red-300">
                                  <p className="font-extrabold text-xl">‚ö†Ô∏è Aviso: A meta anual de NPS 95% √© inating√≠vel.</p>
                                  <p className="mt-2">O NPS m√°ximo que voc√™ pode atingir com o volume de notas projetado √©: <span className="font-extrabold text-red-900">{annualGoalResult.maxNps}%</span>.</p>
                                </div>
                              )}
                            </div>
                          )}
                        </CardContent>
                      </Card>
                      <Card className="bg-red-50 border-red-200 mt-8">
                        <CardHeader>
                          <CardTitle className="text-2xl text-red-800">Gr√°fico de Proje√ß√£o do NPS</CardTitle>
                        </CardHeader>
                        <CardContent>
                          <ResponsiveContainer width="100%" height={300}>
                            <LineChart data={npsProjectionData} margin={{ top: 5, right: 20, left: -20, bottom: 5 }}>
                              <CartesianGrid strokeDasharray="3 3" stroke="#e5e7eb" />
                              <XAxis dataKey="month" />
                              <YAxis domain={[0, 100]} />
                              <Tooltip />
                              <Legend />
                              <Line type="monotone" dataKey="npsCx" name="NPS Projetado" stroke="#a51f38" strokeWidth={3} activeDot={{ r: 8 }} animationDuration={1500} />
                            </LineChart>
                          </ResponsiveContainer>
                          <div className="mt-4 text-center p-4 bg-gray-100 rounded-lg">
                            <p className="text-2xl font-bold text-gray-800">
                              NPS Anual Projetado: <span className="text-red-800">{annualTotals.annualNps}%</span>
                            </p>
                          </div>
                        </CardContent>
                      </Card>
                    </TabsContent>
                    
                    {/* ABA C√ÅLCULO INVERSO */}
                    <TabsContent value="inverse" className="mt-4">
                      <h3 className="text-2xl font-bold mb-4 text-gray-800">C√°lculo Inverso (Meta de NPS 95)</h3>
                      <p className="text-gray-600 mb-6">
                        Informe o volume total de notas que voc√™ espera obter por m√™s para ver a distribui√ß√£o necess√°ria para alcan√ßar um NPS de 95.
                      </p>
                      <div className="flex flex-col md:flex-row items-end space-y-4 md:space-y-0 md:space-x-4 mb-6 p-6 bg-gray-50 border rounded-lg shadow-inner">
                        <div className="flex-grow w-full">
                          <Label htmlFor="total-notas" className="text-base text-gray-700">Volume Total de Notas por M√™s</Label>
                          <Input
                            id="total-notas"
                            type="number"
                            value={totalNotas}
                            onChange={(e) => setTotalNotas(parseInt(e.target.value, 10) || 0)}
                            className="mt-2 text-center"
                          />
                        </div>
                        <Button onClick={handleInverseCalculation} className="bg-green-600 hover:bg-green-700 text-white shadow-lg w-full md:w-auto">
                          Calcular Meta Mensal
                        </Button>
                      </div>
                      {inverseResults.length > 0 && (
                        <Card className="bg-green-50 border-green-200">
                          <CardHeader>
                            <CardTitle className="text-2xl text-green-800">Resultados para a Meta de NPS 95</CardTitle>
                            <CardDescription className="text-green-700">
                              A meta √© um NPS de 95. Os valores abaixo indicam a distribui√ß√£o necess√°ria de feedback.
                            </CardDescription>
                          </CardHeader>
                          <CardContent>
                            <div className="overflow-x-auto rounded-xl shadow-lg">
                              <table className="w-full text-left border-collapse">
                                <thead>
                                  <tr className="bg-green-600 text-white font-bold text-base">
                                    <th className="p-4 rounded-tl-xl">M√™s</th>
                                    <th className="p-4 text-center">Total Notas</th>
                                    <th className="p-4 text-center">Promotores</th>
                                    <th className="p-4 text-center">Detratores</th>
                                    <th className="p-4 text-center">Neutros</th>
                                    <th className="p-4 text-center rounded-tr-xl">NPS Calculado</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  {inverseResults.map((result, index) => (
                                    <tr key={index} className="border-b border-gray-200 hover:bg-green-100">
                                      <td className="p-4 font-medium">{result.month}</td>
                                      <td className="p-4 text-center">{result.totalNotas}</td>
                                      <td className="p-4 text-center">{result.promotores}</td>
                                      <td className="p-4 text-center">{result.detratores}</td>
                                      <td className="p-4 text-center">{result.neutros}</td>
                                      <td className="p-4 font-bold text-center text-green-800">{result.npsCalculado}%</td>
                                    </tr>
                                  ))}
                                </tbody>
                              </table>
                            </div>
                          </CardContent>
                        </Card>
                      )}
                    </TabsContent>

                    {/* ABA CORRELA√á√ÉO DE INDICADORES */}
                    <TabsContent value="correlation" className="mt-4">
                      <h3 className="text-2xl font-bold mb-4 text-gray-800">Correla√ß√£o de Indicadores</h3>
                      <p className="text-gray-600 mb-6">
                        Ajuste os valores dos indicadores projetados para ver a correla√ß√£o estat√≠stica entre o NPS CX e o NP CX (MD).
                      </p>
                      <div className="overflow-x-auto mb-6 rounded-xl shadow-lg">
                        <table className="w-full text-left border-collapse">
                          <thead>
                            <tr className="bg-indigo-700 text-white font-bold text-base">
                              <th className="p-4 border-r rounded-tl-xl">M√™s/Ano</th>
                              <th className="p-4 border-r">Status</th>
                              <th className="p-4 text-center">NPS CX</th>
                              <th className="p-4 text-center rounded-tr-xl">NP CX (MD)</th>
                            </tr>
                          </thead>
                          <tbody>
                            {correlationData.map((monthData, index) => (
                              <tr key={index} className={`border-b border-gray-200 ${monthData.status === 'Projetado' ? 'bg-indigo-50 text-indigo-800 font-semibold' : 'hover:bg-gray-50'}`}>
                                <td className="p-4 font-medium border-r">{monthData.month}</td>
                                <td className="p-4 border-r text-sm text-center">
                                  <select
                                    value={monthData.status}
                                    onChange={(e) => handleCorrelationStatusChange(index, e.target.value)}
                                    className={`block w-full rounded-md border border-gray-300 p-2 text-sm shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500
                                    ${monthData.status === 'Fechado' ? 'bg-gray-200 text-gray-600' : 'bg-white text-gray-900'}`}
                                  >
                                    <option value="Fechado">Fechado</option>
                                    <option value="Projetado">Projetado</option>
                                  </select>
                                </td>
                                <td className="p-4 text-center">
                                  <Input
                                    type="number"
                                    value={monthData.indicadorA}
                                    onChange={(e) => handleCorrelationProjectionChange(index, 'indicadorA', e.target.value)}
                                    className="w-full text-center"
                                    disabled={monthData.status === 'Fechado'}
                                  />
                                </td>
                                <td className="p-4 text-center">
                                  <Input
                                    type="number"
                                    value={monthData.indicadorB}
                                    onChange={(e) => handleCorrelationProjectionChange(index, 'indicadorB', e.target.value)}
                                    className="w-full text-center"
                                    disabled={monthData.status === 'Fechado'}
                                  />
                                </td>
                              </tr>
                            ))}
                          </tbody>
                        </table>
                      </div>
                      <Card className="bg-indigo-50 border-indigo-200 mt-8">
                        <CardHeader>
                          <CardTitle className="text-2xl text-indigo-800">Resultado da Correla√ß√£o</CardTitle>
                        </CardHeader>
                        <CardContent>
                          <p className="text-xl font-bold text-indigo-900">
                            Coeficiente de Correla√ß√£o ($r$): <span className="text-indigo-800">{correlationResult !== null ? correlationResult.toFixed(2) : 'N/A'}</span>
                          </p>
                          <p className="mt-4 text-gray-700">
                            <strong>Explica√ß√£o:</strong> {correlationExplanation}
                          </p>
                          <p className="mt-4 text-sm text-gray-500 italic">
                            O Coeficiente de Correla√ß√£o de Pearson ($r$) mede a for√ßa e a dire√ß√£o de uma rela√ß√£o linear entre duas vari√°veis. O valor varia de -1 (correla√ß√£o negativa perfeita) a +1 (correla√ß√£o positiva perfeita), sendo 0 a aus√™ncia de correla√ß√£o linear.
                          </p>
                        </CardContent>
                      </Card>
                    </TabsContent>
                    
                    {/* ABA AN√ÅLISE MENSAL */}
                    <TabsContent value="monthlyAnalysis" className="mt-4">
                      <Card className="bg-white border-gray-200">
                        <CardHeader>
                          <CardTitle className="text-2xl text-gray-800">Script: Proje√ß√£o de NPS</CardTitle>
                          <CardDescription className="text-gray-600">
                            Preencha os dados atuais para gerar um script de an√°lise e um plano de a√ß√£o para atingir a meta de NPS.
                          </CardDescription>
                        </CardHeader>
                        <CardContent className="space-y-8">
                           <div className="space-y-2">
                              <Label htmlFor="collaboratorName">Nome do Colaborador</Label>
                              <Input id="collaboratorName" type="text" placeholder="Digite o nome do colaborador" value={monthlyAnalysisData.collaboratorName} onChange={e => handleMonthlyAnalysisChange('collaboratorName', e.target.value)} />
                            </div>

                          {/* INPUTS E TABELA DE METAS */}
                          <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                            {/* Coluna de Inputs */}
                            <div className="p-6 bg-gray-50 rounded-lg shadow-inner space-y-6">
                               <div className="space-y-4">
                                <h5 className="font-semibold text-lg text-gray-700">Ultimo registo fechado</h5>
                                <div className="space-y-2">
                                  <Label htmlFor="lastClosedProm">Promotores</Label>
                                  <Input id="lastClosedProm" type="number" placeholder="Valor do m√™s anterior" value={monthlyAnalysisData.lastClosedProm} onChange={e => handleMonthlyAnalysisChange('lastClosedProm', e.target.value)} />
                                </div>
                                <div className="space-y-2">
                                  <Label htmlFor="lastClosedNeut">Neutros</Label>
                                  <Input id="lastClosedNeut" type="number" placeholder="Valor do m√™s anterior" value={monthlyAnalysisData.lastClosedNeut} onChange={e => handleMonthlyAnalysisChange('lastClosedNeut', e.target.value)} />
                                </div>
                                <div className="space-y-2">
                                  <Label htmlFor="lastClosedDetra">Detratores</Label>
                                  <Input id="lastClosedDetra" type="number" placeholder="Valor do m√™s anterior" value={monthlyAnalysisData.lastClosedDetra} onChange={e => handleMonthlyAnalysisChange('lastClosedDetra', e.target.value)} />
                                </div>
                                <div className="mt-4 p-4 bg-white rounded-lg text-center shadow-sm">
                                  <p className="font-semibold">Volume Total: <span className="font-bold text-gray-700">{monthlyAnalysisCalcs.totalLastClosedVolume}</span></p>
                                  <p className="font-semibold">NPS: <span className="font-bold text-gray-700">{monthlyAnalysisCalcs.lastClosedNps}%</span></p>
                                </div>
                              </div>
                              <div className="space-y-4 border-t pt-4">
                                <h5 className="font-semibold text-lg text-red-700">Parcial do M√™s</h5>
                                <div className="space-y-2">
                                  <Label htmlFor="partialProm">Promotores</Label>
                                  <Input id="partialProm" type="number" placeholder="Valor parcial do m√™s" value={monthlyAnalysisData.partialProm} onChange={e => handleMonthlyAnalysisChange('partialProm', e.target.value)} />
                                </div>
                                <div className="space-y-2">
                                  <Label htmlFor="partialNeut">Neutros</Label>
                                  <Input id="partialNeut" type="number" placeholder="Valor parcial do m√™s" value={monthlyAnalysisData.partialNeut} onChange={e => handleMonthlyAnalysisChange('partialNeut', e.target.value)} />
                                </div>
                                <div className="space-y-2">
                                  <Label htmlFor="partialDetra">Detratores</Label>
                                  <Input id="partialDetra" type="number" placeholder="Valor parcial do m√™s" value={monthlyAnalysisData.partialDetra} onChange={e => handleMonthlyAnalysisChange('partialDetra', e.target.value)} />
                                </div>
                                <div className="mt-4 p-4 bg-white rounded-lg text-center shadow-sm">
                                  <p className="font-semibold">Volume Parcial: <span className="font-bold text-red-700">{monthlyAnalysisCalcs.totalPartialVolume}</span></p>
                                  <p className="font-semibold">NPS Parcial: <span className="font-bold text-red-700">{monthlyAnalysisCalcs.partialNps}%</span></p>
                                </div>
                              </div>
                              <div className="space-y-4 border-t pt-4">
                                <h5 className="font-semibold text-lg text-gray-700">Proje√ß√£o:</h5>
                                <div className="grid grid-cols-2 gap-4">
                                  <div className="space-y-2">
                                    <Label htmlFor="totalWorkingDays">Dias √öteis no M√™s</Label>
                                    <Input id="totalWorkingDays" type="number" value={monthlyAnalysisData.totalWorkingDays} onChange={e => handleMonthlyAnalysisChange('totalWorkingDays', e.target.value)} />
                                  </div>
                                  <div className="space-y-2">
                                    <Label htmlFor="currentWorkingDay">Dia √ötil Atual</Label>
                                    <Input id="currentWorkingDay" type="number" value={monthlyAnalysisData.currentWorkingDay} onChange={e => handleMonthlyAnalysisChange('currentWorkingDay', e.target.value)} />
                                  </div>
                                </div>
                                <div className="space-y-2">
                                  <Label htmlFor="npsGoal">Meta de NPS</Label>
                                  <Input id="npsGoal" type="number" placeholder="Meta de NPS" value={monthlyAnalysisData.npsGoal} onChange={e => handleMonthlyAnalysisChange('npsGoal', e.target.value)} />
                                </div>
                                <div className="mt-2 p-2 bg-blue-50 rounded-lg text-center text-sm">
                                  <p>Restam <span className="font-bold">{monthlyAnalysisCalcs.remainingWorkingDays}</span> dias √∫teis.</p>
                                  <p>Volume final projetado: <span className="font-bold">{monthlyAnalysisCalcs.finalProjectedVolume}</span></p>
                                </div>
                              </div>
                            </div>

                            {/* Coluna da Tabela de Metas */}
                            <div className="p-6 bg-blue-50 border-blue-200 rounded-lg shadow-inner">
                                <h4 className="text-xl font-bold mb-4 text-blue-800">Metas Projetadas (C√°lculo Inverso)</h4>
                                <p className="text-sm text-gray-600 mb-4">Baseado na parcial do m√™s e na proje√ß√£o de volume, veja os cen√°rios para atingir a meta.</p>
                                <div className="overflow-x-auto">
                                <table className="w-full text-left border-collapse">
                                    <thead>
                                    <tr className="bg-blue-600 text-white font-semibold text-sm">
                                        <th className="p-3 rounded-tl-lg">Cen√°rio</th>
                                        <th className="p-3 text-center">Promotores</th>
                                        <th className="p-3 text-center">Neutros</th>
                                        <th className="p-3 text-center">Detratores</th>
                                        <th className="p-3 text-center rounded-tr-lg">NPS Final</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {monthlyAnalysisCalcs.goalScenarios.map((scenario, index) => (
                                        <tr key={index} className={`border-b border-blue-200 ${!scenario.isPossible ? 'bg-red-100 text-red-800' : 'hover:bg-blue-100'}`}>
                                        <td className="p-3 font-medium">{scenario.name}</td>
                                        <td className="p-3 text-center font-bold">{scenario.prom}</td>
                                        <td className="p-3 text-center font-bold">{scenario.neut}</td>
                                        <td className="p-3 text-center font-bold">{scenario.detra}</td>
                                        <td className={`p-3 text-center font-extrabold ${scenario.nps >= monthlyAnalysisData.npsGoal ? 'text-green-600' : 'text-red-600'}`}>{scenario.nps}%</td>
                                        </tr>
                                    ))}
                                    </tbody>
                                </table>
                                {monthlyAnalysisCalcs.goalScenarios.find(s => !s.isPossible) && (
                                    <div className="mt-4 p-3 bg-red-100 text-red-800 rounded-lg text-center font-semibold">
                                        <p>{monthlyAnalysisCalcs.goalScenarios.find(s => !s.isPossible).message}</p>
                                        <p className="text-sm mt-1">Reforce o script para direcionar o cliente a responder a pesquisa e aumentar o volume!</p>
                                    </div>
                                )}
                                </div>
                            </div>
                          </div>

                        </CardContent>
                      </Card>
                    </TabsContent>

                  </Tabs>
                </CardContent>
              </Card>
              {/* INFORMATIVO DE CR√âDITO ADICIONADO */}
              <footer className="text-center mt-8 pb-4">
                <p className="text-sm text-gray-500">
                  Desenvolvido por Adriana Paiva
                </p>
              </footer>
            </div>
          );
        };

        const rootElement = document.getElementById('root');
        if (rootElement) {
            const root = createRoot(rootElement);
            root.render(<App />);
        }
      }, 100); // Atraso de 100ms para garantir o carregamento do Recharts
    };
  </script>
</body>
</html>
